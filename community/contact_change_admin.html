<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>রক্তদান – Admin Contact Control</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Bengali:wght@400;600;700&display=swap" rel="stylesheet">
<style>
body{font-family:'Noto Sans Bengali',sans-serif;background:#f8f9fa;color:#1d1d1d;margin:0;padding:0;}
.container{max-width:600px;margin:50px auto;padding:20px;background:white;border-radius:20px;box-shadow:0 10px 20px rgba(0,0,0,0.1);}
h2{text-align:center;margin-bottom:20px;}
input{width:100%;padding:12px;margin:10px 0;border-radius:10px;border:1px solid #ddd;}
button{padding:12px 20px;border:none;border-radius:50px;background:#e63946;color:white;cursor:pointer;width:100%;}
button:hover{background:#d62839;}
.success-msg{color:green;text-align:center;margin-top:10px;}
.error-msg{color:red;text-align:center;margin-top:10px;}
.hidden{display:none;}
</style>
</head>
<body>

<div id="loginDiv" class="container">
  <h2>এডমিন লগইন</h2>
  <input type="email" id="adminEmail" placeholder="ইমেইল" required>
  <input type="password" id="adminPassword" placeholder="পাসওয়ার্ড" required>
  <button onclick="adminLogin()">লগইন</button>
  <p id="loginMsg"></p>
</div>

<div id="adminDiv" class="container hidden">
  <h2>যোগাযোগের ঠিকানা আপডেট করুন</h2>
  <input type="text" id="contactAddress" placeholder="ঠিকানা">
  <input type="text" id="contactPhone" placeholder="ফোন">
  <input type="email" id="contactEmail" placeholder="ইমেইল">
  <input type="text" id="mapURL" placeholder="Google Map Embed URL (iframe src)">
  <button onclick="updateContactInfo()">সেভ করুন</button>
  <p id="contactMsg"></p>
  <button style="margin-top:20px;background:#555;" onclick="logout()">লগআউট</button>
</div>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-firestore-compat.js"></script>

<script>
// Firebase Config
const firebaseConfig = {
  apiKey: "AIzaSyAqhLfmOfmP-_8DOcoEH7Ck7fMF9Id4vJ4",
  authDomain: "earn-project-5f892.firebaseapp.com",
  databaseURL: "https://earn-project-5f892-default-rtdb.firebaseio.com/",
  projectId: "earn-project-5f892",
  storageBucket: "earn-project-5f892.firebasestorage.app",
  messagingSenderId: "8457886057",
  appId: "1:8457886057:web:b5e01d0972d169f47085f8"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

// Check if admin is already logged in
window.onload = () => {
  const loggedIn = localStorage.getItem('adminLoggedIn');
  if(loggedIn === 'true'){
    showAdminPanel();
  }
}

// Admin Login
function adminLogin(){
  const email = document.getElementById('adminEmail').value;
  const pass = document.getElementById('adminPassword').value;
  const msg = document.getElementById('loginMsg');
  if(email === 'admincontrol@gmail.com' && pass === 'admincontrol'){
    localStorage.setItem('adminLoggedIn', 'true'); // Save login
    showAdminPanel();
  } else {
    msg.textContent = '❌ লগইন তথ্য সঠিক নয়';
    msg.className = 'error-msg';
  }
}

// Show admin panel
function showAdminPanel(){
  document.getElementById('loginDiv').classList.add('hidden');
  document.getElementById('adminDiv').classList.remove('hidden');
  loadContactInfo();
}

// Logout
function logout(){
  localStorage.removeItem('adminLoggedIn'); // Remove saved login
  document.getElementById('loginDiv').classList.remove('hidden');
  document.getElementById('adminDiv').classList.add('hidden');
}

// Load contact info
async function loadContactInfo(){
  const doc = await db.collection('settings').doc('contactInfo').get();
  if(doc.exists){
    const data = doc.data();
    document.getElementById('contactAddress').value = data.address || '';
    document.getElementById('contactPhone').value = data.phone || '';
    document.getElementById('contactEmail').value = data.email || '';
    document.getElementById('mapURL').value = data.mapURL || '';
  }
}

// Update contact info
async function updateContactInfo(){
  const address = document.getElementById('contactAddress').value;
  const phone = document.getElementById('contactPhone').value;
  const email = document.getElementById('contactEmail').value;
  const mapURL = document.getElementById('mapURL').value;
  await db.collection('settings').doc('contactInfo').set({address, phone, email, mapURL});
  const msg = document.getElementById('contactMsg');
  msg.textContent = '✅ তথ্য সফলভাবে আপডেট হয়েছে!';
  msg.className = 'success-msg';
}
</script>
</body>
</html>