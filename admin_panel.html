<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Dashboard</title>

<!-- Font Awesome for icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;}
body{background:#fff5f5;color:#333;}
header{text-align:center;padding:40px 20px 20px 20px;}
header h1{font-size:2rem;color:#e84118;margin-bottom:10px;}
header p{font-size:1rem;color:#718093;}
main{max-width:1200px;margin:auto;padding:20px;}

/* Summary Cards */
.summary-cards{display:flex;flex-wrap:wrap;justify-content:space-between;gap:20px;margin-bottom:40px;}
.summary-card{flex:1;min-width:200px;background:#fff;padding:25px 20px;border-radius:12px;text-align:center;
    box-shadow:0 6px 12px rgba(0,0,0,0.1);transition:.3s;}
.summary-card:hover{transform:translateY(-5px);box-shadow:0 12px 20px rgba(0,0,0,0.15);}
.summary-card i{font-size:2.5rem;color:#e84118;margin-bottom:15px;}
.summary-card h2{font-size:2rem;margin-bottom:10px;color:#2f3640;}
.summary-card p{font-size:0.9rem;color:#718093;}

/* Tools section */
.tools-section{margin-top:40px;}
.tools-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:20px;}
.tool-card{background:#fff;border-radius:12px;padding:20px 15px;text-align:center;
    box-shadow:0 6px 12px rgba(0,0,0,0.1);transition:.3s;cursor:pointer;text-decoration:none;color:inherit;}
.tool-card:hover{transform:translateY(-5px);box-shadow:0 12px 20px rgba(0,0,0,0.15);}
.tool-card i{font-size:2rem;color:#e84118;margin-bottom:10px;transition:.3s;}
.tool-card:hover i{color:#c23616;}
.tool-card h3{font-size:1rem;margin-bottom:5px;}
.tool-card p{font-size:0.8rem;color:#718093;}

footer{margin-top:60px;text-align:center;padding:20px;background:#e84118;color:#fff;}
@media(max-width:768px){.summary-cards{flex-direction:column;gap:20px;}}

/* Modal */
#donationModal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;
    background:rgba(0,0,0,0.6);justify-content:center;align-items:center;z-index:1000;}
#donationModal .modal-content{background:#fff;padding:30px;border-radius:12px;width:90%;
    max-width:500px;text-align:center;position:relative;}
#donationModal .modal-content span.close{position:absolute;top:10px;right:15px;cursor:pointer;font-size:1.5rem;}
#donationModal .modal-content h2{color:#e84118;margin-bottom:20px;}
#donationModal .modal-cards{display:flex;flex-wrap:wrap;justify-content:center;gap:20px;}
#donationModal .modal-card{flex:1 1 200px;background:#f5f5f5;padding:20px;border-radius:12px;
    text-decoration:none;color:#333;box-shadow:0 4px 8px rgba(0,0,0,0.1);transition:.3s;}
#donationModal .modal-card i{font-size:2rem;color:#e84118;margin-bottom:10px;}
#donationModal .modal-card:hover{transform:translateY(-5px);box-shadow:0 8px 16px rgba(0,0,0,0.15);}
</style>
</head>
<body>

<header>
    <h1>Admin Dashboard</h1>
    <p>ডোনার ও রক্ত কার্যক্রমের দ্রুত অ্যাক্সেস</p>
</header>

<main>
    <!-- ✅ Summary Cards -->
    <div class="summary-cards">
        <div class="summary-card">
            <i class="fas fa-users"></i>
            <h2 id="totalDonors">0</h2>
            <p>মোট ডোনার সংখ্যা</p>
        </div>
        <div class="summary-card">
            <i class="fas fa-hand-holding-medical"></i>
            <h2 id="totalRoktogrohon">0</h2>
            <p>মোট রক্ত গ্রহণ</p>
        </div>
        <div class="summary-card">
            <i class="fas fa-tint"></i>
            <h2 id="confirmedCount">0</h2>
            <p>মোট রক্ত প্রদান</p>
        </div>
    </div>

    <!-- Tools -->
    <div class="tools-section">
        <h2 style="margin-bottom:20px;color:#e84118;">Admin Tools</h2>
        <div class="tools-grid">
            <a href="community/founder_update.html" class="tool-card">
                <i class="fas fa-user-friends"></i>
                <h3>প্রোফাইল ম্যানেজমেন্ট</h3>
                <p>বেসিক তথ্য প্রদান </p>
            </a>
            
            <a href="21_sep_2025/user_list_admin.html" class="tool-card">
    <i class="fas fa-users"></i>
    <h3>রক্তদাতা লিস্ট</h3>
    <p>ইউজার কনট্যাক্ট ম্যানেজমেন্ট</p>
</a>
            
            <a href="javascript:void(0)" class="tool-card" id="donationRequestCard">
                <i class="fas fa-hand-holding-medical"></i>
                <h3>ডোনেশন রিকোয়েস্ট</h3>
                <p>অনুরোধ অনুমোদন</p>
            </a>
            <a href="error.html" class="tool-card">
                <i class="fas fa-tint"></i>
                <h3>রক্ত স্টক</h3>
                <p>স্টক নিয়ন্ত্রণ</p>
            </a>
<a href="/community/notice_admin.html" class="tool-card">
    <i class="fas fa-bullhorn"></i>
    <h3>নোটিশ পাঠান</h3>
    <p>নোটিশ ম্যানেজমেন্ট</p>
</a>
            <a href="contact_request_admin.html" class="tool-card">
                <i class="fas fa-bell"></i>
                <h3>নোটিফিকেশন</h3>
                <p>ডোনার নোটিফাই করুন</p>
            </a>
            <a href="error.html" class="tool-card">
                <i class="fas fa-chart-pie"></i>
                <h3>রিপোর্ট / অ্যানালিটিক্স</h3>
                <p>পরিসংখ্যান দেখুন</p>
            </a>
            <a href="/community/company_admin.html" class="tool-card">
                <i class="fas fa-hands-helping"></i>
                <h3>স্বেচ্ছাসেবক</h3>
                <p>স্বেচ্ছাসেবক ম্যানেজমেন্ট</p>
            </a>
            <a href="error.html" class="tool-card">
                <i class="fas fa-comment-alt"></i>
                <h3>ফিডব্যাক</h3>
                <p>প্রতিক্রিয়া দেখুন</p>
            </a>
            <a href="/community/settings.html" class="tool-card">
                <i class="fas fa-cogs"></i>
                <h3>সেটিংস</h3>
                <p>সিস্টেম কনফিগার</p>
            </a>
            <a href="error.html" class="tool-card">
                <i class="fas fa-life-ring"></i>
                <h3>সাপোর্ট</h3>
                <p>সহায়তা সাপোর্ট</p>
            </a>
        </div>
    </div>
</main>

<!-- Donation Request Modal -->
<div id="donationModal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <h2>ডোনেশন রিকোয়েস্ট</h2>
        <div class="modal-cards">
            <a href="roktodan_request_admin.html" class="modal-card">
                <i class="fas fa-tint"></i>
                <h3>রক্তদান Request</h3>
            </a>
            <a href="roktogrohon_request_admin.html" class="modal-card">
                <i class="fas fa-hand-holding-medical"></i>
                <h3>রক্তগ্রহণ Request</h3>
            </a>
        </div>
    </div>
</div>

<footer>&copy; ইসলামি ব্লাড ফাউন্ডেশন. সকল অধিকার সংরক্ষিত।</footer>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
<script>
const firebaseConfig = {
    apiKey: "AIzaSyAqhLfmOfmP-_8DOcoEH7Ck7fMF9Id4vJ4",
    authDomain: "earn-project-5f892.firebaseapp.com",
    databaseURL: "https://earn-project-5f892-default-rtdb.firebaseio.com/",
    projectId: "earn-project-5f892",
    storageBucket: "earn-project-5f892.firebasestorage.app",
    messagingSenderId: "8457886057",
    appId: "1:8457886057:web:b5e01d0972d169f47085f8"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// Elements
const donorEl        = document.getElementById('totalDonors');
const roktogrohonEl  = document.getElementById('totalRoktogrohon');
const roktoProdanEl  = document.getElementById('totalRoktoProdan');

// ✅ Donor count
db.ref('donors').on('value', snap=>{
    donorEl.textContent = snap.exists() ? Object.keys(snap.val()).length : 0;
});

// ✅ রক্ত গ্রহণ count (শুধু confirmed)
db.ref('requests').on('value', snap=>{
    let count = 0;
    if(snap.exists()){
        Object.values(snap.val()).forEach(r=>{
            if(r.status && r.status.toLowerCase() === 'confirmed') count++;
        });
    }
    roktogrohonEl.textContent = count;
});



// ✅ Fix: Count confirmed donations properly
db.ref('donations').on('value', snap => {
    let count = 0;
    if (snap.exists()) {
        const donationsData = snap.val();
        
        // Nested loop in case donations are stored per user
        Object.values(donationsData).forEach(userOrDonation => {
            if (typeof userOrDonation === 'object') {
                Object.values(userOrDonation).forEach(r => {
                    if (r.status && r.status.toLowerCase().trim() === 'confirmed') count++;
                });
            }
        });
    }
    // Update card
    roktoProdanEl.textContent = count;
    console.log('Confirmed donations count:', count); // Debug
});
// ======== Confirmed Count ========
const confirmedCountEl = document.getElementById('confirmedCount');

firebase.database().ref('bloodRequests').on('value', snapshot => {
    const data = snapshot.val() || {};
    let confirmed = 0;
    
    Object.values(data).forEach(r => {
        if (r.status && r.status.toLowerCase().trim() === 'confirmed') {
            confirmed++;
        }
    });
    
    confirmedCountEl.textContent = confirmed;
});
// ======== Donation Modal Open/Close ========
const modal = document.getElementById('donationModal');
const donationCard = document.getElementById('donationRequestCard');
const closeBtn = modal.querySelector('.close');

// Open modal on click
donationCard.addEventListener('click', () => {
    modal.style.display = 'flex';
});

// Close modal on close button
closeBtn.addEventListener('click', () => {
    modal.style.display = 'none';
});

// Close modal on clicking outside the content
window.addEventListener('click', (e) => {
    if (e.target === modal) modal.style.display = 'none';
});
</script>
</body>
</html>